

모델 전체를 아우르는 **완성된 형태의 JSON 예제**를 보여주고 싶을 때가 있습니다.

예를 들어, 프론트엔드 개발자가 API 문서를 보고 "아, 이 API를 호출하려면 이런 모양의 JSON 객체 하나를 통째로 보내면 되는구나"라고 한 번에 이해할 수 있게 도와주는 것이죠.

이럴 때 모델 내부에 `Config` 클래스를 사용합니다.

### Config 클래스와 schema_extra 

Pydantic 모델 클래스 안에 `Config`라는 내부 클래스를 만들고, 그 안에 `schema_extra`라는 속성을 설정하여 API 문서에 표시될 추가 정보를 정의. 

```
from fastapi import FastAPI
from pydantic import BaseModel, Field

app = FastAPI()

class Image(BaseModel):
    url: str = Field(..., example="http://example.com/image.jpg")
    name: str = Field(..., example="멋진 상품 이미지")

class Item(BaseModel):
    name: str = Field(..., min_length=3, max_length=50)
    description: str | None = Field(default=None, max_length=300)
    price: float = Field(..., gt=0)
    tax: float | None = Field(default=None, ge=0)
    tags: list[str] = Field(default=[])
    image: Image | None = Field(default=None)

    # 1. 모델 내부에 Config 클래스를 추가합니다.
    class Config:
        # 2. json_schema_extra에 보여주고 싶은 예제를 정의합니다.
        json_schema_extra = {
            "example": {
                "name": "완벽한 게이밍 마우스",
                "description": "이 마우스는 당신의 게임 실력을 향상시켜 줄 완벽한 동반자입니다.",
                "price": 75.5,
                "tax": 0.1,
                "tags": ["고성능", "LED", "인체공학"],
                "image": {
                    "url": "http://example.com/gaming_mouse.jpg",
                    "name": "게이밍 마우스 정면 사진"
                }
            }
        }

# API 엔드포인트는 그대로 둡니다.
@app.post("/items/")
def create_item(item: Item):
    return item

# 벌크 엔드포인트도 그대로 둡니다.
@app.post("/items/bulk/")
def create_bulk_items(items: list[Item]):
    return {"message": f"{len(items)} items created.", "data": items}
```


- **`class Config:`**: `Item` 모델 바로 아래에 `Config`라는 이름의 내부 클래스를 선언했습니다. 이 이름은 Pydantic과의 약속이므로 다른 이름으로 바꾸면 안 됩니다.
    
- **`json_schema_extra = { ... }`**: `Config` 클래스의 속성으로 `schema_extra`를 정의했습니다.
    
- **`"example": { ... }`**: `schema_extra` 딕셔너리 안에 `"example"`이라는 키를 사용하고, 그 값으로 API 문서에 보여주고 싶은 완전한 형태의 JSON 객체를 넣어주었습니다. 이 JSON 객체는 당연히 `Item` 모델의 구조를 완벽하게 따라야 합니다.

## `Field`의 `example` vs `Config`의 `json_schema_extra`

- **`Field(example=...)`**: 개별 필드에 대한 예시를 보여줄 때 유용합니다.
    
- **`Config.json_schema_extra`**: 모델 전체의 완전한 예시를 보여줄 때 사용합니다. **만약 둘 다 사용된다면, `Config.json_schema_extra`가 더 높은 우선순위를 가져 API 문서에 표시됩니다.**


## (추가질문) Bulk 랑 단일 아이템 example 구분 방법 

서버(FastAPI)는 JSON 데이터 안에 아이템이 **몇 개가 들어있는지(개수)**로 판단하지 않습니다. 대신, 데이터가 어떤 **괄호로 감싸여 있는지(구조)**를 보고 판단합니다.

- **`{ ... }` (중괄호)**: 이 데이터는 **단일 객체(Object)**입니다.
    
- **`[ ... ]` (대괄호)**: 이 데이터는 **배열(Array/List)**입니다.
    

가장 중요한 점은, 배열(`[]`) 안에는 아이템이 **0개, 1개, 또는 여러 개** 들어갈 수 있다는 것입니다. 아이템이 **단 1개만 들어있어도, 대괄호(`[]`)로 감싸여 있다면 그것은 '리스트'**입니다.

## 정리 

| JSON 데이터의 모양 | FastAPI/Pydantic의 해석 | 매칭되는 엔드포인트 (우리 예시 기준) |
| :--- | :--- | :--- |
| `{ "name": "A", ... }` | `Item` 객체 **1개** | `POST /items/` |
| `[ { "name": "A", ... } ]` | `Item` 객체 **1개**를 담은 **리스트** | `POST /items/bulk/` |
| `[ { "name": "A", ... }, { "name": "B", ... } ]` | `Item` 객체 **2개**를 담은 **리스트** | `POST /items/bulk/` |
