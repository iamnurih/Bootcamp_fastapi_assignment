
이 파일은 'FastAPI 앱' 컨테이너와 'MySQL' 컨테이너를 함께 묶어 실행하는 '지휘자' 역할을 합니다.

```
# docker-compose.yml

version: '3.8'

services:
  # MySQL 데이터베이스 서비스 정의
  db:
    image: mysql:8.0
    cap_add:
      - SYS_NICE
    restart: always
    # DB 컨테이너의 환경 변수 설정
    environment:
      - MYSQL_DATABASE=meetify_db
      - MYSQL_USER=user
      - MYSQL_PASSWORD=password
      - MYSQL_ROOT_PASSWORD=rootpassword
    ports:
      # 내 컴퓨터의 3306 포트와 컨테이너의 3306 포트를 연결
      - "3306:3306"
    volumes:
      # DB 데이터를 내 컴퓨터에 저장하여 영속성 유지
      - db_data:/var/lib/mysql

  # FastAPI 애플리케이션 서비스 정의
  app:
    # 현재 폴더의 Dockerfile을 사용하여 이미지 빌드
    build: .
    restart: always
    ports:
      # 내 컴퓨터의 8000 포트와 컨테이너의 8000 포트를 연결
      - "8000:8000"
    volumes:
      # 내 컴퓨터의 app 폴더와 컨테이너의 app 폴더를 실시간 동기화
      - ./app:/code/app
    # .env 파일의 내용을 컨테이너 환경 변수로 주입
    env_file:
      - ./.env
    # db 서비스가 시작된 후에 app 서비스를 시작
    depends_on:
      - db

# 데이터 영속성을 위한 볼륨 정의
volumes:
  db_data:

```


### 1. `db` 서비스 (MySQL) 상세 설명

- **`image: mysql:8.0`**: "Docker Hub라는 온라인 창고에서 **MySQL 8.0 버전의 공식 이미지**를 다운로드해서 사용해줘." 라는 뜻입니다.
    
- **`environment`**: MySQL 컨테이너가 처음 시작될 때 필요한 **설정값**들입니다.
    
    - `MYSQL_DATABASE=meetify_db`: `meetify_db`라는 이름의 데이터베이스를 자동으로 생성해줘.
        
    - `MYSQL_USER=user`, `MYSQL_PASSWORD=password`: `user`라는 이름의 사용자를 `password`라는 비밀번호로 생성해줘.
        
    - `MYSQL_ROOT_PASSWORD=rootpassword`: MySQL의 최고 관리자(root) 비밀번호를 설정해줘.
        
- **`ports: - "3306:3306"`**: "내 컴퓨터의 **3306번 포트**로 들어오는 요청을 컨테이너의 **3306번 포트**로 연결해줘." 라는 뜻입니다. 덕분에 우리가 사용하는 DB 관리 툴(DBeaver, DataGrip 등)에서 `localhost:3306`으로 컨테이너 안의 DB에 접속할 수 있습니다.
    
- **`volumes: - db_data:/var/lib/mysql`**: **데이터를 영구적으로 저장**하기 위한 가장 중요한 설정입니다. "컨테이너 안의 `/var/lib/mysql` 폴더(MySQL 데이터가 실제로 저장되는 곳)를 `db_data`라는 이름의 외부 볼륨에 연결해줘." 라는 뜻입니다. 이렇게 하면 컨테이너를 삭제하고 다시 만들어도 데이터는 그대로 보존됩니다.
    

---

### 2. `app` 서비스 (FastAPI) 상세 설명

- **`build: .`**: "이 서비스의 이미지는 외부에서 다운로드하지 말고, 현재 폴더에 있는 **`Dockerfile`을 사용해서 직접 만들어줘.**" 라는 뜻입니다.
    
- **`ports: - "8000:8000"`**: "내 컴퓨터의 **8000번 포트**를 컨테이너의 **8000번 포트**로 연결해줘." 덕분에 우리가 웹 브라우저에서 `localhost:8000`으로 접속할 수 있습니다.
    
- **`volumes: - ./app:/code/app`**: 개발 환경의 핵심입니다. "내 컴퓨터의 **`./app` 폴더**와 컨테이너안의 **`/code/app` 폴더**를 **실시간으로 동기화**해줘." 라는 뜻입니다. 우리가 코드를 수정하고 저장하면, 그 내용이 즉시 컨테이너 안에도 반영됩니다.
    
- **`env_file: - ./.env`**: "프로젝트 루트에 있는 **`.env` 파일**의 모든 내용을 이 컨테이너의 환경 변수로 로드해줘." 라는 뜻입니다.
    
- **`depends_on: - db`**: "이 `app` 서비스를 시작하기 전에, 반드시 `db` 서비스가 먼저 준비될 때까지 기다려줘." 라는 실행 순서 지정입니다. 데이터베이스가 켜지기도 전에 앱이 실행되어 DB에 연결하려다 실패하는 것을 막아줍니다.
    

**결론적으로, 이 파일은 대부분의 웹 프로젝트에서 거의 그대로 재사용할 수 있습니다.** 프로젝트에 따라 데이터베이스 이름이나 비밀번호를 바꾸거나, 나중에 Redis 같은 새로운 서비스를 추가하는 식으로 확장해 나가면 됩니다.

